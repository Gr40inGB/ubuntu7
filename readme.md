### 1. Установить Nginx
   
```bash
richard@ubuntutuntu:~$ sudo apt install nginx -y
```
убедимся, что работает
```bash
richard@ubuntutuntu:~$ sudo systemctl status nginx

   ```


2. ** настроить Nginx на работу с PHP-FPM.
3. Установить Apache.
остановим nginx и установим apache2
```bash
richard@ubuntutuntu:~$ sudo systemctl stop nginx
richard@ubuntutuntu:~$ sudo systemctl status nginx

richard@ubuntutuntu:~$ sudo apt install apache2
richard@ubuntutuntu:~$ sudo systemctl status apache2

```
### 4. ** Настроить обработку PHP. Добиться одновременной работы с Nginx.
### 5. Настроить схему обратного прокси для Nginx (динамика - на Apache).


перенастроим порт 
file /etc/apache2/ports.conf
```bash
# If you just change the port or add more ports here, you will likely also
# have to change the VirtualHost statement in
# /etc/apache2/sites-enabled/000-default.conf

Listen 5555

<IfModule ssl_module>
#	Listen 443
</IfModule>

<IfModule mod_gnutls.c>
#	Listen 443
</IfModule>

# vim: syntax=apache ts=4 sw=4 sts=4 sr noet

```

file /etc/apache2/sites-available/000-default.conf
```bash
<VirtualHost *:5555>
	# The ServerName directive sets the request scheme, hostname and port that
	# the server uses to identify itself. This is used when creating
	# redirection URLs. In the context of virtual hosts, the ServerName
	# specifies what hostname must appear in the request's Host: header to
	# match this virtual host. For the default virtual host (this file) this
	# value is not decisive as it is used as a last resort host regardless.
	# However, you must set it for any further virtual host explicitly.
	#ServerName www.example.com

	ServerAdmin webmaster@localhost
	DocumentRoot /var/www/html

	# Available loglevels: trace8, ..., trace1, debug, info, notice, warn,
	# error, crit, alert, emerg.
	# It is also possible to configure the loglevel for particular
	# modules, e.g.
	#LogLevel info ssl:warn

	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/access.log combined

	# For most configuration files from conf-available/, which are
	# enabled or disabled at a global level, it is possible to
	# include a line for only one particular virtual host. For example the
	# following line enables the CGI configuration for this host only
	# after it has been globally disabled with "a2disconf".
	#Include conf-available/serve-cgi-bin.conf
</VirtualHost>

# vim: syntax=apache ts=4 sw=4 sts=4 sr noet
```

проверяем :
```bash
richard@ubuntutuntu:/etc/apache2$ sudo systemctl reload apache2
richard@ubuntutuntu:/etc/apache2$ sudo apachectl -t

richard@ubuntutuntu:/etc/apache2$ sudo systemctl start nginx
richard@ubuntutuntu:/etc/apache2$ sudo ss -ntlp
                                                                  
```

file /etc/nginx/sites-available/default
```bash 

server {
	listen 80 default_server;
	listen [::]:80 default_server;

	# SSL configuration
	#
	# listen 443 ssl default_server;
	# listen [::]:443 ssl default_server;
	#
	# Note: You should disable gzip for SSL traffic.
	# See: https://bugs.debian.org/773332
	#
	# Read up on ssl_ciphers to ensure a secure configuration.
	# See: https://bugs.debian.org/765782
	#
	# Self signed certs generated by the ssl-cert package
	# Don't use them in a production server!
	#
	# include snippets/snakeoil.conf;

	root /var/www/html;

	# Add index.php to the list if you are using PHP
	index index.html index.htm index.nginx-debian.html;

	server_name _;

	location / {
		# First attempt to serve request as file, then
		# as directory, then fall back to displaying a 404.
	#	try_files $uri $uri/ =404;
		proxy_pass http://localhost:5555;
		proxy_set_header Host Shost;
		proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
		proxy_set_header X-Real-IP Sremote_addr;
	}

	  location ~* ^.+.(jpg|jpeg|gif|png|ico|css|zip|pdf|txt|tar|js)$ {
             root /var/www/html;
	}

}

```

проверка  

```bash
richard@ubuntutuntu:/etc/nginx$ sudo nginx -t
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful
```
пришло осознание. что натсройка php apache была видимо лишней. Перехожу к настройке php-fpm

```bash
richard@ubuntutuntu:/etc/nginx$ cd ..
richard@ubuntutuntu:/etc$ cd apache2/
richard@ubuntutuntu:/etc/apache2$ sudo nano mods-enabled/php8.1.conf 
richard@ubuntutuntu:/etc/apache2$ cd /etc/nginx/
richard@ubuntutuntu:/etc/nginx$ sudo su
root@ubuntutuntu:/etc/nginx# cd /var/www/html/
root@ubuntutuntu:/var/www/html# nano inffo.php
root@ubuntutuntu:/var/www/html# apt install php-fpm 

root@ubuntutuntu:/var/www/html# cd /etc/php/
root@ubuntutuntu:/etc/php# ll
total 20
drwxr-xr-x   3 root root  4096 июл 15 03:14 ./
drwxr-xr-x 133 root root 12288 июл 15 03:14 ../
drwxr-xr-x   6 root root  4096 июл 15 03:31 8.1/
root@ubuntutuntu:/etc/php# cd 8.1/
root@ubuntutuntu:/etc/php/8.1# ll
total 24
drwxr-xr-x 6 root root 4096 июл 15 03:31 ./
drwxr-xr-x 3 root root 4096 июл 15 03:14 ../
drwxr-xr-x 3 root root 4096 июл 15 03:14 apache2/
drwxr-xr-x 3 root root 4096 июл 15 03:14 cli/
drwxr-xr-x 4 root root 4096 июл 15 03:31 fpm/
drwxr-xr-x 2 root root 4096 июл 15 03:14 mods-available/
root@ubuntutuntu:/etc/php/8.1# cd fpm/
root@ubuntutuntu:/etc/php/8.1/fpm# ll
total 96
drwxr-xr-x 4 root root  4096 июл 15 03:31 ./
drwxr-xr-x 6 root root  4096 июл 15 03:31 ../
drwxr-xr-x 2 root root  4096 июл 15 03:31 conf.d/
-rw-r--r-- 1 root root  5457 июн 28 19:01 php-fpm.conf
-rw-r--r-- 1 root root 72928 июн 28 19:01 php.ini
drwxr-xr-x 2 root root  4096 июл 15 03:31 pool.d/
root@ubuntutuntu:/etc/php/8.1/fpm# cd pool.d/
root@ubuntutuntu:/etc/php/8.1/fpm/pool.d# ll
total 32
drwxr-xr-x 2 root root  4096 июл 15 03:31 ./
drwxr-xr-x 4 root root  4096 июл 15 03:31 ../
-rw-r--r-- 1 root root 20876 июн 28 19:01 www.conf
root@ubuntutuntu:/etc/php/8.1/fpm/pool.d# nano www.conf 
root@ubuntutuntu:/etc/php/8.1/fpm/pool.d# cd /etc/nginx/sites-enabled/
root@ubuntutuntu:/etc/nginx/sites-enabled# nano default 
root@ubuntutuntu:/etc/nginx/sites-enabled# nginx -t
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful
root@ubuntutuntu:/etc/nginx/sites-enabled# cat nano
cat: nano: No such file or directory
root@ubuntutuntu:/etc/nginx/sites-enabled# cat default 
##
# You should look at the following URL's in order to grasp a solid understanding
# of Nginx configuration files in order to fully unleash the power of Nginx.
# https://www.nginx.com/resources/wiki/start/
# https://www.nginx.com/resources/wiki/start/topics/tutorials/config_pitfalls/
# https://wiki.debian.org/Nginx/DirectoryStructure
#
# In most cases, administrators will remove this file from sites-enabled/ and
# leave it as reference inside of sites-available where it will continue to be
# updated by the nginx packaging team.
#
# This file will automatically load configuration files provided by other
# applications, such as Drupal or Wordpress. These applications will be made
# available underneath a path with that package name, such as /drupal8.
#
# Please see /usr/share/doc/nginx-doc/examples/ for more detailed examples.
##

# Default server configuration
#
server {
	listen 80 default_server;
	listen [::]:80 default_server;

	# SSL configuration
	#
	# listen 443 ssl default_server;
	# listen [::]:443 ssl default_server;
	#
	# Note: You should disable gzip for SSL traffic.
	# See: https://bugs.debian.org/773332
	#
	# Read up on ssl_ciphers to ensure a secure configuration.
	# See: https://bugs.debian.org/765782
	#
	# Self signed certs generated by the ssl-cert package
	# Don't use them in a production server!
	#
	# include snippets/snakeoil.conf;

	root /var/www/html;

	# Add index.php to the list if you are using PHP
	index index.html index.htm index.nginx-debian.html;

	server_name _;

	location / {
		# First attempt to serve request as file, then
		# as directory, then fall back to displaying a 404.
	#	try_files $uri $uri/ =404;
		proxy_pass http://localhost:5555;
		proxy_set_header Host Shost;
		proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
		proxy_set_header X-Real-IP Sremote_addr;
	}

	  location ~* ^.+.(jpg|jpeg|gif|png|ico|css|zip|pdf|txt|tar|js)$ {
             root /var/www/html;
	}

	# pass PHP scripts to FastCGI server
	#
	location ~ \.php$ {
		include snippets/fastcgi-php.conf;
	#
	#	# With php-fpm (or other unix sockets):
		fastcgi_pass unix:/run/php/php8.1-fpm.sock;
	#	# With php-cgi (or other tcp sockets):
	#	fastcgi_pass 127.0.0.1:9000; 
	}

	# deny access to .htaccess files, if Apache's document root
	# concurs with nginx's one
	#
	#location ~ /\.ht {
	#	deny all;
	#}
}

root@ubuntutuntu:/etc/nginx/sites-enabled# systemctl reload nginx

```


### 6. Установить MySQL. Создать новую базу данных и таблицу в ней.
```bash
root@ubuntutuntu:/etc/nginx/sites-enabled# exit
exit
richard@ubuntutuntu:/etc/nginx$ sudo apt install mysql-server -y
[sudo] password for richard: 


richard@ubuntutuntu:/etc/nginx$ sudo -ss -ntlp
root@ubuntutuntu:/etc/nginx# exit
exit
richard@ubuntutuntu:/etc/nginx$ sudo ss -ntlp
State         Recv-Q        Send-Q                Local Address:Port                  Peer Address:Port        Process                                                                                                        
LISTEN        0             128                       127.0.0.1:631                        0.0.0.0:*            users:(("cupsd",pid=1059,fd=7))                                                                               
LISTEN        0             70                        127.0.0.1:33060                      0.0.0.0:*            users:(("mysqld",pid=22127,fd=21))                                                                            
LISTEN        0             511                         0.0.0.0:80                         0.0.0.0:*            users:(("nginx",pid=21291,fd=6),("nginx",pid=21290,fd=6),("nginx",pid=21289,fd=6),("nginx",pid=21288,fd=6),("nginx",pid=12305,fd=6))
LISTEN        0             4096                  127.0.0.53%lo:53                         0.0.0.0:*            users:(("systemd-resolve",pid=736,fd=14))                                                                     
LISTEN        0             151                       127.0.0.1:3306                       0.0.0.0:*            users:(("mysqld",pid=22127,fd=23))                                                                            
LISTEN        0             511                               *:5555                             *:*            users:(("apache2",pid=19970,fd=4),("apache2",pid=19736,fd=4),("apache2",pid=19735,fd=4),("apache2",pid=19734,fd=4),("apache2",pid=19733,fd=4),("apache2",pid=19732,fd=4),("apache2",pid=19728,fd=4))
LISTEN        0             128                           [::1]:631                           [::]:*            users:(("cupsd",pid=1059,fd=6))                                                                               
LISTEN        0             511                            [::]:80                            [::]:*            users:(("nginx",pid=21291,fd=7),("nginx",pid=21290,fd=7),("nginx",pid=21289,fd=7),("nginx",pid=21288,fd=7),("nginx",pid=12305,fd=7))


richard@ubuntutuntu:/etc/nginx$ sudo mysql -u root -p
Enter password: 
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 8
Server version: 8.0.33-0ubuntu0.22.04.2 (Ubuntu)

Copyright (c) 2000, 2023, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> \h

For information about MySQL products and services, visit:
   http://www.mysql.com/
For developer information, including the MySQL Reference Manual, visit:
   http://dev.mysql.com/
To buy MySQL Enterprise support, training, or other products, visit:
   https://shop.mysql.com/

List of all MySQL commands:
Note that all text commands must be first on line and end with ';'
?         (\?) Synonym for `help'.
clear     (\c) Clear the current input statement.
connect   (\r) Reconnect to the server. Optional arguments are db and host.
delimiter (\d) Set statement delimiter.
edit      (\e) Edit command with $EDITOR.
ego       (\G) Send command to mysql server, display result vertically.
exit      (\q) Exit mysql. Same as quit.
go        (\g) Send command to mysql server.
help      (\h) Display this help.
nopager   (\n) Disable pager, print to stdout.
notee     (\t) Don't write into outfile.
pager     (\P) Set PAGER [to_pager]. Print the query results via PAGER.
print     (\p) Print current command.
prompt    (\R) Change your mysql prompt.
quit      (\q) Quit mysql.
rehash    (\#) Rebuild completion hash.
source    (\.) Execute an SQL script file. Takes a file name as an argument.
status    (\s) Get status information from the server.
system    (\!) Execute a system shell command.
tee       (\T) Set outfile [to_outfile]. Append everything into given outfile.
use       (\u) Use another database. Takes database name as argument.
charset   (\C) Switch to another charset. Might be needed for processing binlog with multi-byte charsets.
warnings  (\W) Show warnings after every statement.
nowarning (\w) Don't show warnings after every statement.
resetconnection(\x) Clean session context.
query_attributes Sets string parameters (name1 value1 name2 value2 ...) for the next query to pick up.
ssl_session_data_print Serializes the current SSL session data to stdout or file

For server side help, type 'help contents'

mysql> show databases
    -> :
    -> ;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':' at line 2
mysql> show databases ;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| sys                |
+--------------------+
4 rows in set (0,00 sec)

mysql> create database blablabla;
Query OK, 1 row affected (0,01 sec)

mysql> use blablabla
Database changed
mysql> show tables
    -> ;
Empty set (0,00 sec)

mysql> create table cats;
ERROR 4028 (HY000): A table must have at least one visible column.
mysql> create table cats
    -> ;
ERROR 4028 (HY000): A table must have at least one visible column.
mysql> create table cats(id INT, name varchar(150));
Query OK, 0 rows affected (0,00 sec)

mysql> show tables
    -> ;
+---------------------+
| Tables_in_blablabla |
+---------------------+
| cats                |
+---------------------+
1 row in set (0,00 sec)

mysql> insert into cats values (0, 'ssya'),(1,'ssik'),(2,'lka');
Query OK, 3 rows affected (0,00 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> show tables
    -> ;
+---------------------+
| Tables_in_blablabla |
+---------------------+
| cats                |
+---------------------+
1 row in set (0,00 sec)

mysql> select * from cats
    -> ;
+------+------+
| id   | name |
+------+------+
|    0 | ssya |
|    1 | ssik |
|    2 | lka  |
+------+------+
3 rows in set (0,00 sec)

mysql> exit
Bye
richard@ubuntutuntu:/etc/nginx$ sudo apt install phpmyadmin

```

7. ** Установить пакет phpmyadmin и запустить его веб-интерфейс для управления MySQL.